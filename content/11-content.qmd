---
title: "Measurement from a Causal Perspective"
date: "2023-MAY-30"
---
  
  
## Overview

By the end of this lecture you will: 

1. Understand the causal assumptions implied by the factor analytic interpretation of the formative and reflective models. 

2. Be able to distinguish between statistical and structural interpretations of these models. 

3. Understand why Vanderweele thinks consistent causal estimation is possible using the theory of multiple versions of treatments for constructs with multiple indicators  



```{r}
#| include: false
#| echo: false
#read libraries

library("tinytex")
library(extrafont)
loadfonts(device = "all")

# read libraries
source("/Users/joseph/GIT/templates/functions/libs2.R")

# read functions
#source("/Users/joseph/GIT/templates/functions/funs.R")
```


## Two ways of thinking about measurement in psychometric research. 

Reflective and formative models represent two distinct conceptualizations of how latent variables and their indicators are related in psychometric research.

### Reflective Model (Factor Analysis)

In a reflective measurement model, also known as an effect indicator model, the latent variable is understood to cause the observed variables. In this model, changes in the latent variable cause changes in the observed variables. Each indicator (observed variable) is a 'reflection' of the latent variable. In other words, they are effects or manifestations of the latent variable. These relations are presented in @fig-dag-latent-1.

Mathematically, the reflective model is expressed:

   $$X_i = \lambda_i \eta + \varepsilon_i$$

Here, $X_i$ is an observed variable (indicator), $\lambda_i$ is the factor loading for $X_i$, $\eta$ is the latent variable, and $\varepsilon_i$ is the error term associated with $X_i$. It is assumed that all the indicators are interchangeable and have a common cause, which is the latent variable $\eta$.

One of the critical assumptions of a reflective model is that the indicators are correlated because they are all caused by the same latent variable. This means that if the latent variable were to change, we would expect a corresponding change in the indicators.


```{tikz}
#| label: fig-dag-latent-1
#| fig-cap: "Reflective model: assume univariate latent variable η giving rise to indicators X1...X3. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"
#| out-width: 80%
#| echo: false
\usetikzlibrary{positioning}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows}
\usetikzlibrary{decorations}
\tikzstyle{Arrow} = [->, thin, preaction = {decorate}]
\tikzset{>=latex}



\begin{tikzpicture}[{every node/.append style}=draw]

\node [rectangle, draw=white] (eta) at (0, 0) {$\eta$};
\node [rectangle, draw=white] (X1) at (6, 1) {X$_1$};
\node [rectangle, draw=white] (X2) at (6, 0) {$\vdots$};
\node [rectangle, draw=white] (Xn) at (6, -1) {X$_n$};

\draw [-latex, draw=black] (eta) to (X1);
\draw [-latex, draw=black] (eta) to (X2);
\draw [-latex, draw=black] (eta) to (Xn);

\end{tikzpicture}
```


### The Formative Model (Factor Analysis)

Contrary to the reflective model, in a formative measurement model, also known as a causal indicator model, the observed variables (indicators) are seen as causing or determining the latent variable. The latent variable is formed or caused by the indicators. These relations are presented in @fig-dag-latent-formative_0.

Mathematically the foramative model is expressed:

   $$\eta = \sum_i\lambda_i X_i + \varepsilon$$

In this equation, $\eta$ is the latent variable, $\lambda_i$ is the weight for $X_i$ (the observed variable), and $\varepsilon$ is the error term. The latent variable $\eta$ is a composite of the observed variables $X_i$.

In a formative model, the indicators may not be correlated, and they are not interchangeable, as they all contribute uniquely to the latent variable. This means that a change in one indicator does not necessarily imply a change in the other indicators.


```{tikz}
#| label: fig-dag-latent-formative_0
#| fig-cap: "Formative model:: assume univariate latent variable from which the indicators X1...X3 give rise. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"
#| out-width: 80%
#| echo: false
\usetikzlibrary{positioning}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows}
\usetikzlibrary{decorations}
\tikzstyle{Arrow} = [->, thin, preaction = {decorate}]
\tikzset{>=latex}



\begin{tikzpicture}[{every node/.append style}=draw]

\node [rectangle, draw=black] (X1) at (0, 1) {X1};
\node [rectangle, draw=white] (X2) at (0, 0) {$\vdots$};
\node [rectangle, draw=black] (Xn) at (0, -1) {X$_n$};
\node [rectangle, draw=white] (eta) at (6, 0) {$\eta$};


\draw [-latex, draw=black] (X1) to (eta);
\draw [-latex, draw=black] (X2) to (eta);
\draw [-latex, draw=black] (Xn) to (eta);

\end{tikzpicture}
```


## Structural Interpretation of the formative model and reflective models (Factor Analysis)

> However, this analysis of reflective and formative models assumed that the latent η was causally efficacious. This may not be the case (VanderWeele 2022)

VanderWeele distinguishes between statistical and structural models.

1. **Statistical Model:** A statistical model refers to the mathematical relationships, such as the equations mentioned above, which describe how observed variables (indicators) relate to latent variables. It is generally expressed in terms of equations that involve parameters (such as factor loadings in the factor analysis context) and random variables. In the context of factor analysis, statistical models are employed to describe the pattern of covariation among the observed variables in terms of a smaller number of unobserved, latent variables.  $A = f(X1, X2 \dots X_n)$ is a statistical model 

2. **Structural Model:** A structural model refers to the causal assumptions or hypotheses about the relationships among variables in a statistical model. It reflects the theoretical structure of the construct under investigation. Structural models represent theories about causal relationships and are often depicted graphically in diagrams. They provide a way of visually interpreting the implications of the statistical model and allow for a deeper understanding of the causal structures that could potentially give rise to the observed data. @fig-dag-latent-formative_0  and @fig-dag-latent-1 are structural models. 

In the context of factor analysis, the reflective and formative models have been taken each to represent the distinct models.

- We have seen that the **reflective model** statistically implies that the observed variables (indicators) are reflections or manifestations of the latent variable, expressed as $X_i = \lambda_i \eta + \varepsilon_i$. However, the factor analytic tradition makes the additional assumption that the latent variable is causally efficacious and influences the observed variables. However, as we shall see, these causal assumptions may not always hold true.

- We have seen that the **formative model** statistically implies that the latent variable is formed or influenced by the observed variables, expressed as $\eta = \sum_i\lambda_i X_i + \varepsilon$. However, the factor analytic tradition makes the additional assumption that the observed variables give rise to the latent variable. As with the reflective model, the causal assumptions inherent in the formative model may not always hold true.

**While cross-sectional data can provide insights into the relationships between variables, they can't conclusively determine the causal direction of these relationships.** 


::: {#fig-latent layout-ncol=1}


```{tikz}
#| label: fig-structural-assumptions-reflective-model
#| fig-cap: "Reflective Model: causal assumptions. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"
#| out-width: 100%
#| echo: false

\usetikzlibrary{positioning}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows}
\usetikzlibrary{decorations}
\tikzstyle{Arrow} = [->, thin, preaction = {decorate}]
\tikzset{>=latex}

\begin{tikzpicture}[{every node/.append style}=draw]
\node [rectangle, draw=black] (L) at (0, 0) {L};
\node [rectangle, draw=white] (eta) at (2, 0) {$\eta$};
\node [rectangle, draw=white] (X1) at (4, 1) {X1};
\node [rectangle, draw=white] (X2) at (4, 0) {$\vdots$};
\node [rectangle, draw=white] (Xn) at (4, -1) {X$_n$};
\node [rectangle, draw=white] (A) at (6, 0) {A};

\node [rectangle, draw=white] (Y) at (8, 0) {Y};

\draw [-latex, bend right=80, draw=black] (L) to (Y);
\draw [-latex, draw=black] (L) to (eta);
\draw [-latex, bend left=90, draw=red] (eta) to (Y);
\draw [-latex, draw=black] (eta) to (X1);
\draw [-latex, draw=black] (eta) to (X2);
\draw [-latex, draw=black] (eta) to (Xn);

\draw [-latex, draw=black] (X1) to (A);
\draw [-latex, draw=black] (X2) to (A);
\draw [-latex, draw=black] (Xn) to (A);

\end{tikzpicture}
```


```{tikz}
#| label: fig-dag-reflective-assumptions_note
#| fig-cap: "Formative model: causal assumptions. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"
#| out-width: 100%
#| echo: false

\usetikzlibrary{positioning}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows}
\usetikzlibrary{decorations}
\tikzstyle{Arrow} = [->, thin, preaction = {decorate}]
\tikzset{>=latex}

\begin{tikzpicture}[{every node/.append style}=draw]


\node [draw=black] (L) at (0, 0) {L};
\node [rectangle, draw=black] (X1) at (3, 1) {X1};
\node [rectangle, draw=white] (X2) at (3, 0) {$\vdots$};
\node [rectangle, draw=black] (Xn) at (3, -1) {X$_n$};
\node [rectangle, draw=white] (eta) at (6, 0) {$\eta$};
\node [rectangle, draw=white] (Y) at (9, 0) {Y};



\draw [-latex, draw=black] (X1) to (eta);
\draw [-latex, draw=black] (X2) to (eta);
\draw [-latex, draw=black] (Xn) to (eta);
\draw [-latex, bend right=80, draw=black] (L) to (Y);
\draw [-latex, draw=black, bend left = 80] (L) to (eta);
\draw [-latex, draw=red] (eta) to (Y);


\end{tikzpicture}
```

The reflective model implies $X_i = \lambda_i \eta + \varepsilon_i$, which factor analysts take to imply @fig-structural-assumptions-reflective-model. 

The formative model implies $\eta = \sum_i\lambda_i X_i + \varepsilon$, which factor analysts take to imply @fig-dag-reflective-assumptions_note. 

:::


## Interpretation Issues with Traditional Factor Analysis

While the statistical model $X_i = \lambda_i \eta + \varepsilon_i$ aligns with @fig-structural-assumptions-reflective-model, it is equally in agreement with @fig-dag-formative-assumptions-compatible. Cross-sectional data, unfortunately, do not provide enough information to discern between these structural interpretations.

Similarly, the statistical model $\eta = \sum_i\lambda_i X_i + \varepsilon$ agrees with @fig-dag-reflective-assumptions_note but also agrees with @fig-dag-reflectiveassumptions-compatible_again. Here too, cross-sectional data prove insufficient to distinguish between these two potential structural interpretations.

And there are other structural possibilities that cohere with these equations. The takeaway is that the data we collect can align with numerous possible realities, as show in @fig-dag-multivariate-reality_again and @fig-dag-multivariate-reality-bulbulia.


::: {#fig-latent layout-ncol=1}

```{tikz}
#| label: fig-dag-formative-assumptions-compatible
#| fig-cap: "Formative model is compatible with indicators causing outcome.Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"
#| out-width: 100%
#| echo: false


\begin{tikzpicture}[{every node/.append style}=draw]
%\node [rectangle, draw=white] (L) at (0, 0) {L};
\node [rectangle, draw=white] (eta) at (2, 0) {$\eta$};
\node [rectangle, draw=white] (X1) at (4, 1) {X1};
\node [rectangle, draw=white] (X2) at (4, 0) {$\vdots$};
\node [rectangle, draw=white] (Xn) at (4, -1) {X$_n$};
\node [rectangle, draw=white] (Y) at (6, 0) {Y};

%\draw [-latex, bend right=80, draw=black] (L) to (Y);
%\draw [-latex, bend left=60, draw=black] (L) to (X1);
%\draw [-latex, bend left=40, draw=black] (L) to (X2);
%\draw [-latex, bend right=60, draw=black] (L) to (Xn);

\draw [-latex, draw=black] (eta) to (X1);
\draw [-latex, draw=black] (eta) to (X2);
\draw [-latex, draw=black] (eta) to (Xn);

\draw [-latex, draw=red] (X1) to (Y);
\draw [-latex, draw=red] (X2) to (Y);
\draw [-latex, draw=red] (Xn) to (Y);


\end{tikzpicture}
```



```{tikz}
#| label: fig-dag-reflectiveassumptions-compatible_again
#| fig-cap: "Reflective model is compatible with indicators causing the outcome. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"
#| out-width: 100%
#| echo: false

\usetikzlibrary{positioning}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows}
\usetikzlibrary{decorations}
\tikzstyle{Arrow} = [->, thin, preaction = {decorate}]
\tikzset{>=latex}

\begin{tikzpicture}[{every node/.append style}=draw]


%\node [draw=white] (L) at (0, 0) {L};
\node [rectangle, draw=white] (X1) at (2, 1) {X1};
\node [rectangle, draw=white] (X2) at (2, 0) {$\vdots$};
\node [rectangle, draw=white] (Xn) at (2, -1) {X$_n$};
\node [rectangle, draw=white] (eta) at (4, 0) {$\eta$};
\node [rectangle, draw=white] (Y) at (6, 0) {Y};



\draw [-latex, draw=black] (X1) to (eta);
\draw [-latex, draw=black] (X2) to (eta);
\draw [-latex, draw=black] (Xn) to (eta);
%\draw [-latex, bend left=80, draw=black] (L) to (Y);
\draw [-latex, bend left=60, draw=red] (X1) to (Y);
\draw [-latex, bend left=40, draw=red] (X2) to (Y);
\draw [-latex, bend right =60,  draw=red] (Xn) to (Y);



\end{tikzpicture}
```


```{tikz}
#| label: fig_dag_multivariate_reality_again
#| fig-cap: "Multivariate reality gives rise to the indicators, from which we draw our measures. Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"
#| out-width: 100%
#| echo: false

\usetikzlibrary{positioning}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows}
\usetikzlibrary{decorations}
\tikzstyle{Arrow} = [->, thin, preaction = {decorate}]
\tikzset{>=latex}

\begin{tikzpicture}[{every node/.append style}=draw]


\node [draw=white] (eta1) at (0, 1) {$\eta_1$};
\node [rectangle, draw=white] (eta2) at (0, 0) {$\vdots$};
\node [rectangle, draw=white] (etan) at (0, -1) {$\eta_n$};
\node [rectangle, draw=white] (X1) at (2, 1) {X$_1$};
\node [rectangle, draw=white] (X2) at (2, 0) {$\vdots$};
\node [rectangle, draw=white] (Xn) at (2, -1 ) {X$_n$};
\node [rectangle, draw=white] (A) at (4, 0 ) {A};
\node [rectangle, draw=white] (Y) at (6, 0 ) {Y};



\draw [-latex, draw=black] (eta1) to (X1);
\draw [-latex, draw=black] (eta2) to (X2);
\draw [-latex, draw=black] (etan) to (Xn);

\draw [-latex, draw=black] (X1) to (A);
\draw [-latex, draw=black] (X2) to (A);
\draw [-latex, draw=black] (Xn) to (A);
\draw [-latex, bend left=80, draw=red] (eta1) to (Y);
\draw [-latex, bend right=80, draw=red] (etan) to (Y);



\end{tikzpicture}
```

```{tikz}
#| label: fig-dag-multivariate-reality-bulbulia
#| fig-cap: "Although we take our constructs, A, to be functions of indicators, X, such that, perhaps only one or several of the indicators are efficacious.Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"
#| out-width: 100%
#| echo: false

\usetikzlibrary{positioning}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows}
\usetikzlibrary{decorations}
\tikzstyle{Arrow} = [->, thin, preaction = {decorate}]
\tikzset{>=latex}

\begin{tikzpicture}[{every node/.append style}=draw]


\node [draw=white] (eta1) at (0, 1) {$\eta_1$};
\node [rectangle, draw=white] (eta2) at (0, 0) {$\vdots$};
\node [rectangle, draw=white] (etan) at (0, -1) {$\eta_n$};
\node [rectangle, draw=white] (X1) at (2, 1) {X$_1$};
\node [rectangle, draw=white] (X2) at (2, 0) {$\vdots$};
\node [rectangle, draw=white] (Xn) at (2, -1 ) {X$_n$};
\node [rectangle, draw=white] (Y) at (6, 0 ) {Y};



\draw [-latex, draw=black] (eta1) to (X1);
\draw [-latex, draw=black] (eta2) to (X2);
\draw [-latex, draw=black] (etan) to (Xn);


\draw [-latex, bend left=80, draw=red] (eta1) to (Y);



\end{tikzpicture}
```



The statistical models that underpin formative and reflective conceptions of factor analysis are compatible with indicators having causal effects, and with a multivariate reality giving rise to multiple indicators.

:::




## The theory of mutliple versions of treatment


```{tikz}
#| label: fig_dag_multiple_version_treatment_dag
#| fig-cap: "Multiple Versions of treatment. Heae, A is regarded to bbe a coarseneed version of K"
#| out-width: 100%
#| echo: false


\usetikzlibrary{positioning}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows}
\usetikzlibrary{decorations}
\tikzstyle{Arrow} = [->, thin, preaction = {decorate}]
\tikzset{>=latex}



\begin{tikzpicture}[{every node/.append style}=draw]

\node [rectangle, draw=black] (L0) at (0, 0) {L};
\node [rectangle, draw=white] (K1) at (2, 0) {K};
\node [rectangle, draw=black] (A1) at (4, 0) {A};
\node [rectangle, draw=white] (Y2) at (6, 0) {Y$_k$};

\draw [-latex, draw=black] (L0) to (K1);
\draw [-latex, bend right, draw=black] (L0) to (Y2);
\draw [-latex, draw=black] (K1) to (A1);
\draw [-latex, draw=black, bend left] (K1) to (Y2);

\end{tikzpicture}
```


Recall, a causal effect is defined as the difference in the expected potential outcome when everyone is exposed (perhaps contrary to fact) to one level of a treatment, conditional on their levels of a confounder,  with the expected potential outcome when everyone is exposed to a a different level of a treatement  (perhaps contrary to fact), conditional on their levels of a counfounder.  


$$ \delta = \sum_l \left( \mathbb{E}[Y|A=a,l] - \mathbb{E}[Y|A=a^*,l] \right) P(l)$$



where $\delta$ is the causal estimand on the difference scale $(\mathbb{E}[Y^0 - Y^0])$. In causal inference, the multiple versions of treatment theory allows us to handle situations where the treatment isn't uniform, but instead has several variations. Each variation of the treatment, or "version", can have a different impact on the outcome. This theory allows us to consider these varying impacts in our causal models.

Under the multiple versions of treatment framework, the consistency assumption is redefined. It requires that for each version of the treatment, the outcome under that version is equal to the observed outcome when that version is received. 

Further, a "no confounding" assumption is required, which states that the potential outcomes for each version are independent of the version received, given the covariates.


The absence of confounding for the effect of $K$ on $Y$ given $L$ is denoted when Y$_k$ is independent of $K$, conditionally based on $C$ or $Y_k \coprod A|K,L$ (i.e. conditional on$L$, $A$ gives no information about $Y$ once $K$ and $L$ are accounted for) . The consistency assumption is deemed to be valid when $Y = Y_k$ if $K = k$. See @fig_dag_multiple_version_treatment_dag.

Let's assume the researcher only possesses data on $(A, Y, L)$. When Y$_k$ is conditionally independent of $K$ based on $L$, there is no confounding for the effect of $K$ on $Y$ given $L$. Then for any  $K = k$ results in $Y = Y_k$, the consistency assumption is met. Let's suppose only information on $(A, Y, L)$  is available to the researcher.



$$ \delta = \sum_{k,l} \mathbb{E}[Y_k|l] P(k|a,l) P(l) - \sum_{k,l} \mathbb{E}[Y_k|l] P(k|a^*,l) P(l)$$


It represents a comparison in a hypothetical randomised trial. In this scenario, within covariates $L$ strata, individuals in one group receive a treatment $K$ version randomly assigned from the inherent $K$ distribution in the $(A = a, L = l)$ sub-population. Meanwhile, individuals in the other group receive a randomly assigned $K$ version from the same distribution.

This theory finds its utility in practical scenarios where treatments seldom resemble each other, like healthcare where different doctors may administer slightly distinct treatments, or in education where teaching methods differ. By incorporating these treatment variations, we gain more accurate insights into the causal effect.

So VanderWeele proposes that this theory of causal inference under multiple treatments could be advantageous for handling the consistency assumption. 


He next proposes that this theory may be helpful for explaining measurements. 


### Reflective and formative measurement models may be approached from the Multiple Versions of Treatment Theory.


Recall the theory of multiple versions of treatments. This concept accounts for varying impacts of different treatment versions on the outcome. The consistency assumption is revisited.When a specific version of treatment is received, the observed outcome matches the outcome under *that* version. In addition, the theory requires "no confounding" given measured covariates for each version are of the treatment.


Vanderweele applies the following substitution: 


$$\delta = \sum_{\eta,l} \mathbb{E}[Y_\eta|l] P(\eta|A=a+1,l) P(l) - \sum_{\eta,l} \mathbb{E}[Y_\eta|l] P(\eta|A=a,l) P(l)$$
VanderWeele substitutes $K$ with $\eta$ from the previous section, and compare measurement level $A = a + 1$ with $A = a$. Now, if the influence of $\eta$ on $Y$ is not confounded given $L$

Thus despite varying reliabilities $\eta_i$, which might be overlooked, $\delta$ retains its interpretability as a comparison in a hypothetical randomised trial. 

Here, within the strata of covariates $L$, individuals in one group are randomised to a value of $\eta$, derived from the actual $\eta$ distribution in the subpopulation with $(A = a + 1, L = l)$. In the other group, individuals are randomized to a $\eta$ value from the distribution in the subpopulation with $(A = a, L = l)$.

This connection between measurement and the multiple versions of treatment framework provides a powerful tool for causal inference varying reliabilities of measurement.

However, as with the theory of multiple treatments, we might not known how to interpret our results.  Similar considerations and warnings apply to the "formative model of measurement."



```{tikz}
#| label: fig-dag-multiple-version-treatment-applied-measurement
#| fig-cap: "Multiple Versions of treatment applied to measuremen.Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"
#| out-width: 100%
#| echo: false


\usetikzlibrary{positioning}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows}
\usetikzlibrary{decorations}
\tikzstyle{Arrow} = [->, thin, preaction = {decorate}]
\tikzset{>=latex}



\begin{tikzpicture}[{every node/.append style}=draw]

\node [rectangle, draw=black] (L0) at (0, 0) {L};
\node [rectangle, draw=white] (K1) at (2, 0) {$\eta$=K};
\node [rectangle, draw=white] (X1) at (5, 0) {$(X_1, X_2, \dots X_n)$};
\node [rectangle, draw=black] (A1) at (8, 0) {A};
\node [rectangle, draw=white] (Y2) at (10, 0) {Y$_k$};

\draw [-latex, draw=black] (L0) to (K1);
\draw [-latex, bend right, draw=black] (L0) to (Y2);
\draw [-latex, draw=black] (K1) to (X1);
\draw [-latex, draw=black] (X1) to (A1);
\draw [-latex, draw=black, bend left] (K1) to (Y2);

\end{tikzpicture}
```


## VanderWeele's model of reality

> A preliminary outline of a more adequate approach to the construction and use of psychosocial measures might thus be summarized by the following propositions, that I have argued for in this article: (1) Traditional univariate reflective and formative models do not adequately capture the relations between the underlying causally relevant phenomena and our indicators and measures. (2) The causally relevant constituents of reality related to our constructs are almost always multidimensional, giving rise both to our indicators from which we construct measures, and also to our language and concepts, from which we can more precisely define constructs. (3) In measure construction, we ought to always specify a definition of the underlying construct, from which items are derived, and by which analytic relations of the items to the definition are made clear. (4) The presumption of a structural univariate reflective model impairs measure construction, evaluation, and use. (5) If a structural interpretation of a univariate reflective factor model is being proposed this should be formally tested, not presumed; factor analysis is not sufficient for assessing the relevant evidence. (6) Even when the causally relevant constituents of reality are multidimensional, and a univariate measure is used, we can still interpret associations with outcomes using theory for multiple versions of treatment, though the interpretation is obscured when we do not have a clear sense of what the causally relevant constituents are. (7) When data permit, examining associations item-by-item, or with conceptually related item sets, may give insight into the various facets of the construct.

>A new integrated theory of measurement for psychosocial constructs is needed in light of these points – one that better respects the relations between our constructs, items, indicators, measures, and the underlying causally relevant phenomena.  (VanderWeele 2022)



```{tikz}
#| label: fig-dag-multivariate-reality-complete
#| fig-cap: "Multivariate reality gives rise to the latent variables.Figure adapted from VanderWeele: doi: 10.1097/EDE.0000000000001434"
#| out-width: 100%
#| echo: false

\usetikzlibrary{positioning}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows}
\usetikzlibrary{decorations}
\tikzstyle{Arrow} = [->, thin, preaction = {decorate}]
\tikzset{>=latex}

\begin{tikzpicture}[{every node/.append style}=draw]


\node [rectangle, draw=white] (R) at (0, 0 ) {$\mathcal{R}$};
\node [rectangle, draw=white] (c) at (2, -1 ) {concepts};
\node [rectangle, draw=white] (cs) at (4, -2 ) {constructs};
\node [rectangle, draw=white] (eta) at (4, 0 ) {$\eta$};
\node [rectangle, draw=white] (X) at (6, 0 ) {(X$_1 \dots$X$_n$)};
\node [rectangle, draw=white] (A) at (8, 0 ) {A};
\node [rectangle, draw=white] (Y) at (10, 0 ) {Y};



\draw [-latex, draw=black, dashed] (R) to (c);
\draw [-latex, draw=black, dashed] (c) to (cs);
\draw [-latex, draw=black] (R) to (eta);
\draw [-latex, draw=black] (eta) to (X);
\draw [-latex, draw=black] (X) to (A);



\draw [-latex, bend left=80, draw=red] (eta) to (Y);



\end{tikzpicture}
```


However, this is not a causal graph. Can we do better? The arrows to not clearly represent causal relations.

## I suggest that the theory of dependent and directed measurement error might be usefully employed to develop a pragmatic responses to construct measurement


The New Zealand Attitudes and Values Study (NZAVS) is  national probability survey collects a wide range of information, including data on stress levels, exercise habits, and cultural backgrounds.


```{tikz}
#| label: fig-dag-dep-udir-effect-confounders-3wave
#| fig-cap: "Measurement error opens a pathway to confounding if either there are correlated errors, or a directed effect of the exposure on the errors of measured outcome."
#| out-width: 100%
#| echo: false
\usetikzlibrary{positioning}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows}
\usetikzlibrary{decorations}



\tikzstyle{Arrow} = [->, thin, preaction = {decorate}]
\tikzset{>=latex}

\tikzset{blackArrowRedTip/.style={
  decoration={markings, mark=at position 1 with {\arrow[red, thick]{latex}}},
  postaction={decorate},
  shorten >=0.4pt}}

% Define a simple decoration
\tikzstyle{cor} = [-, dotted, preaction = {decorate}]


\begin{tikzpicture}[{every node/.append style}=draw]

\node [rectangle, draw=white] (ULAY) at (0, 5) {$U_{L}$};
\node [rectangle, draw=white] (UA) at (5, 4) {$U_{A}$};
\node [rectangle, draw=white] (UY) at (10, 5) {$U_{Y}$};

\node [rectangle, draw=black] (L0) at (0, 2) {L$_{f(X_1\dots X_n)}^{t0}$};
\node [rectangle, draw=black] (A1) at (5, 2) {A$_{f(X_1\dots X_n)}^{t1}$};
\node [rectangle, draw=black] (Y2) at (10, 2) {Y$_{f(X_1\dots X_n)}^{t2}$};
\node [rectangle, draw=white] (Leta0) at (0, 0) {$\eta_L^{t0}$};
\node [rectangle, draw=white] (Aeta1) at (5, 0) {$\eta_A^{t1}$};
\node [rectangle, draw=white] (Yeta2) at (10, 0) {$\eta_Y^{t2}$};


\draw [-latex, draw=red] (ULAY) to (UA);
\draw [-latex, draw=red] (ULAY) to (UY);

\draw [-latex, draw=black] (UA) to (A1);
\draw [-latex, draw=red] (UY) to (Y2);
\draw [-latex, draw=black] (ULAY) to (L0);
\draw [-latex, draw=black] (Leta0) to (L0);
\draw [-latex, draw=black] (Leta0) to (Aeta1);
\draw [-latex, draw=black, bend right=30] (Leta0) to (Yeta2);

\draw [-latex, draw = black] (Aeta1) to (A1);
\draw [-latex, draw=black] (Yeta2) to (Y2);

\draw [-latex, draw=red] (Aeta1) to (UY);
\draw [-latex, draw=red] (Leta0) to (UA);





%\draw [-latex, draw=black] (Leta0) to (UA);



\draw [cor, draw=red, dashed,bend right=80] (ULAY) to (Leta0);
\draw [cor, draw=red, dashed, bend right = 80] (UA) to (Aeta1);
%\draw [cor, draw=red, dashed, bend left = 80] (UY) to (Yeta2);

\end{tikzpicture}
```


Consider a study investigating the impact of a person's true state of regular exercise, represented as $\eta_A$ in the diagram @fig-dag-dep-udir-effect-confounders-3wave, on their true distress state, represented as $\eta_Y$. There is a potential confounder in this study, which is the person's true state of daily stress level, represented as $\eta_L$.

Each of these variables is potentially subject to measurement error, which we denote in the graph as $U_{L}$ for daily stress, $U_{A}$ for regular exercise, and $U_{Y}$ for mood state. The true states of these variables are assumed to affect their corresponding measured states, represented in the diagram as $L_{f(X_1\dots X_n)}$, $A_{f(X_1\dots X_n)}$, and $Y_{f(X_1\dots X_n)}$.

Suppose we have reason to think that that these measurement errors, or unmeasured sources of error, affect the measured states: $U_{L} \rightarrow$ $L_{f(X_1\dots X_n)}$, $U_{A} \rightarrow$ $A_{f(X_1\dots X_n)}$, and $U_{Y} \rightarrow$ $Y_{f(X_1\dots X_n)}$.

Furthermore, suppose we have reason to think that the errors are correlated such that a person experiencing high levels of stress ($U_{L}$) might inaccurately report their exercise levels and mood state, leading to an assumed correlation in errors: $U_{L} \rightarrow U_{A}$, and $U_{L} \rightarrow U_{Y}$.

Finally, as indicated in the causal diagramme  @fig-dag-dep-udir-effect-confounders-3wave, suppose we have reason to think that the true state of exercise impacts the measurement error in mood, and the true state of stress impacts the measurement error in exercise. This is represented in  @fig-dag-dep-udir-effect-confounders-3wave by the red arrows from $\eta_A \rightarrow U_{Y}$ and from $\eta_L \rightarrow U_{A}$. The connections from $U_{L}$ to $\eta_L$ and from $U_{A}$ to $\eta_A$ indicate the relationships between the unmeasured sources of error and the true states of stress and exercise, respectively.

How might such dynamics play out? 

Let's consider $U_{L}$, the unmeasured source of error in daily stress levels. This could arise from variations in individual perceptions of stress, as stress is a subjective experience and the way it's reported can depend on factors like cultural backgrounds, recent personal experiences, or even how a person interprets the survey question. For example, an event one participant deems stressful, another might consider trivial. These factors are not measured in the NZAVS but could affect participants' reported stress levels.

$U_{A}$, the unmeasured source of error in regular exercise habits, could be the effect of social desirability bias. Participants might overestimate or underestimate their exercise levels based on what they perceive as socially acceptable or desirable. It could also be influenced by memory recall biases, as the survey asks about past behaviours that might not be accurately remembered.

$U_{Y}$, the unmeasured source of error in distress states, could be affected by the participant's immediate circumstances. For instance, a participant might be experiencing a particularly good or bad day when they complete the survey, which could affect how they report their general mood state. Additionally, language and cultural differences in describing and interpreting mood states could also introduce measurement error.

Next consider the effects of true states on measurement errors

The directed effect of the true state of exercise, $\eta_A$, on the measurement error in distress, $U_{Y}$, could be understood in the context of the potential mood-enhancing effects of exercise. If a participant has been exercising regularly (true state of exercise), they might be in a better mood when filling out the survey, which could lead to an overestimation of their general mood state due to this temporary mood boost.

Likewise, the directed effect of the true state of stress, $\eta_L$, on the measurement error in exercise, $U_{A}$, might arise if high stress levels lead a participant to underestimate their exercise levels. High stress might hinder recall of past exercise behaviours or lead to a more negative interpretation of one's behaviours, thus introducing measurement error in reported exercise habits.

The diagram, therefore, captures the multiple pathways by which measurement error and confounding can arise in a setting of survey research, demonstrating the complex relationships between true states, measured variables, and their associated errors.


### How to think about complex causal dynamics

Now VanderWeele's thoughts highlight the complexity and challenges of effectively capturing psychological constructs. Let's extend the previous example by incorporating these two theories of measurement. 

Consider the concept of stress ($\eta_Y$) in the NZAVS. This not a simple univariate variable; instead, it represents a complex psychological construct. In a formative sense, we might consider various indicators such as the Kessler-6 scale (discussed last week) to form a measure of stress. Each of these indicators contributes to measuring the construct of stress. However, they are not necessarily caused by single univariate "Kessler-6" entity out there in the world. More likely it is a rather a complex, multi-dimensional underlying reality that combines an individual's life circumstances and mental and physical health that gives rise to these indicators. Culture, too might play a systematic role. 

Yet, as VanderWeele argues, the formative model doesn't fully capture the relationship between measures and the underlying reality. The stress level measured in the NZAVS is not just a function of these indicators; it also reflects an underlying complex reality that affects and is affected by these indicators. Put differently, the concept of stress is not simply a combination of these indicators, but rather, it's a complex construct emerging from a multitude of physiological, psychological, and environmental factors.

Let's develop this example with Tyler's ideas in mind:

1. $\eta_L \rightarrow L$: The true state of stress influences the measured stress level. However, this measurement is also subject to the unmeasured error source, $U_{L}$.

2. $\eta_A \rightarrow A$: Similarly, the true state of exercise influences the measured exercise level, but it is subject to $U_{A}$, the unmeasured error source in the exercise measurement.

3. $\eta_Y \rightarrow Y$: The true state of mood affects the measured mood level, which is also influenced by $U_{Y}$, the unmeasured error source in mood measurement.

4. $U_{L} \rightarrow L$, $U_{A} \rightarrow A$, and $U_{Y} \rightarrow Y$: Each unmeasured source of error influences the corresponding measurement, causing discrepancies between the true states and the measured states.

5. $U_{L} \rightarrow U_{A}$ and $U_{L} \rightarrow U_{Y}$: The unmeasured error source in stress measurement is correlated with those in the exercise and mood measurements. This could be due to common sources of error such as similar biases in self-reporting across these constructs.

6. $\eta_A \rightarrow U_{Y}$ and $\eta_L \rightarrow U_{A}$: The true state of exercise affects the unmeasured source of error in the distress measurement, and the true state of stress affects the unmeasured source of error in the exercise measurement. This could happen if high stress or high exercise levels make respondents more prone to certain biases or errors in other measures.

In all of these processes, as we have imagined them, the measurements of stress, exercise, and distress states reflect a more complex underlying reality, and they are also subject to multiple unmeasured sources of error. Understanding this complexity and the dynamics is critical. 

###  Control for baseline measures helps: the promise and perils

We have adopted the three-wave panel design for counding control in which we adjust for baseline measurements of the exposure and outcome. We can now, in light of potentially directed and correlated measurement errors, better understand the strengths and limitations of the three wave approach.

1. **Baseline Measures and Cultural Differences:** The NZAVS contains data from diverse cultural backgrounds. Therefore, controlling for baseline measures of exercise and mood would also help account for cultural differences that might influence these variables at the outset. For instance, certain cultural groups might have different baseline levels of physical activity or baseline mood states due to various socio-cultural factors.

2. **Residual Confounding and Exercise:** Let's consider the construct $\eta_{A}$, representing the true state of exercise behaviour. If we control for baseline exercise, we're adjusting for the initial level of this behaviour. However, there could still be cultural factors that impact how exercise changes over time. For instance, a cultural event or festival that significantly increases physical activity for a certain period might occur. This change might be independent of the baseline level of exercise, thus leading to residual confounding.

3. **Residual Confounding and Depression:** Similarly for $\eta_{Y}$, the true state of Depression/Anxiety. Controlling for baseline states adjusts for the initial emotional state. However, cultural factors such as societal norms or expectations about emotional expression could change over time independently of the baseline distress. These changes could result in residual confounding. For example, a significant cultural event might induce communal feelings of joy or sadness, influencing the distress state irrespective of the baseline level.

4. **Unmeasured Cultural Factors**: It's also important to consider that cultural influences might not be entirely captured by the survey. Factors such as societal expectations, shared beliefs, and norms within a culture could influence both exercise behaviour and distress states. These could change over time due to sociocultural shifts, and if these changes aren't accounted for, could lead to residual confounding. For example, a societal shift towards valuing physical health might encourage more exercise independently of baseline levels.

5. **Change over time**: Finally, time itself can be a factor. Changes in cultural norms and attitudes can occur over the duration of a longitudinal study like the NZAVS. If the timing of these changes isn't aligned with the measurement times, this can also lead to residual confounding. For example, if there is a cultural shift towards increased acceptance of mental health issues, this might change how mood is reported over time, irrespective of baseline levels.

6. **Directed Measurement Error:** Consider a situation where individuals from certain cultural backgrounds might systematically under-report their physical activity due to societal norms or expectations, introducing a directed measurement error. Similarly, reporting of mood states might also be influenced by cultural perspectives on expressing emotions. These culturally influenced errors in measurement can introduce bias, even after controlling for baseline measures.

7. **Undirected Measurement Error:** Undirected errors could also occur due to random variations in understanding or interpreting survey questions across different cultures, introducing variability in the data. If these random errors correlate with the error in measuring other variables (for instance, if misunderstanding of exercise questions correlates with misunderstanding of mood questions), this can introduce bias.

8. **Correlated Errors and Cultural Differences:** The culturally influenced measurement errors ($U_{A}$, $U_{Y}$) could be correlated, as the cultural factors influencing the reporting of exercise might also influence the reporting of mood. This correlation between errors introduces further complexity and potential bias.

9. **Residual Confounding:** Despite controlling for baseline measures, there can still be residual confounding due to unmeasured cultural factors. For instance, even if we control for baseline exercise and mood, there might still be cultural factors that impact the changes in these variables over time independently of the baseline measures. 

In short, controlling for baseline measures in the NZAVS helps to reduce some bias and account for cultural differences that influence the exposure and outcome. However, potential bias due to unmeasured confounding and measurement error, for example, if these are influenced by cultural factors, still remain. 

10. **Need for Sensitivity Analysis** The Key takehome message is that we must always perform sensitivity analyses because we can never be certain that our confounding control strategy has worked. 


<!-- ```{tikz} -->
<!-- #| label: fig-dag-multivariate-reality-complete-bulbulia -->
<!-- #| fig-cap: "Multivariate reality gives rise to the latent variables,if reality continues to strongly effect η at t0 ...tn, there is an open backdoor path to Y through our concepts and constructs." -->
<!-- #| out-width: 100% -->
<!-- #| echo: false -->

<!-- \usetikzlibrary{positioning} -->
<!-- \usetikzlibrary{shapes.geometric} -->
<!-- \usetikzlibrary{arrows} -->
<!-- \usetikzlibrary{decorations} -->
<!-- \tikzstyle{Arrow} = [->, thin, preaction = {decorate}] -->
<!-- \tikzset{>=latex} -->

<!-- \begin{tikzpicture}[{every node/.append style}=draw] -->


<!-- \node [rectangle, draw=white, align=left] (R) at (0, 0 ) {$\mathcal{R}$\\ -->
<!--   concepts$^{~}$\\constructs$^{~}$}; -->
<!-- \node [rectangle, draw=white] (eta0) at (3, 0 ) {$\eta^{t0}$}; -->
<!-- \node [rectangle, draw=black] (X0) at (6, 0 ) {$(X_1 \dots X_n)^{t0}$}; -->
<!-- \node [rectangle, draw=white] (eta1) at (10, 0 ) {$\eta^{t1}$}; -->
<!-- \node [rectangle, draw=black] (X1) at (12, 0 ) {$(X_1 \dots X_n)^{t1}$}; -->
<!-- \node [rectangle, draw=white] (Y) at (14, 0 ) {Y$^{t2}$}; -->




<!-- \draw [-latex, draw=red, bend left=80] (R) to (Y); -->
<!-- \draw [-latex, draw=black] (R) to (eta0); -->
<!-- \draw [-latex, draw=black, bend left, red] (R) to (eta1); -->
<!-- \draw [-latex, draw=black] (eta0) to (X0); -->
<!-- \draw [-latex, draw=black, bend right=40] (eta0) to (X1); -->
<!-- \draw [-latex, draw=black] (eta1) to (X1); -->
<!-- \draw [-latex, draw=red,dotted, bend left=40] (eta1) to (Y); -->






<!-- \end{tikzpicture} -->
<!-- ``` -->


  
  
## Slides
